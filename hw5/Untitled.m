% turn = 12
total_BER = [
    0.117615384615385	0.0486875000000000	0.0249344262295082	0.0134464285714286	0.00724761904761905	0.00383418367346939	0.00196209150326797 0.00095632156825626 0.0004651359592182  0.0002162198462628  .0001056218962133;
    0.0519000000000000	0.0168666666666667  0.00800800000000000 0.00374906367041199	0.00172852233676976	0.000652376514445480	0.000297457627118644	0.000126445086705202    4.97477080520219e-05    1.94322780950269e-05    1.62924982629322e-06;
    0.0410769230769231	0.0135810810810811	0.00533157894736842	0.00215698924731183	0.000893655049151028	0.000289495450785773	0.000114622564270509	3.79917855598789e-05    1.18218665558096e-05    4.80769230769231e-06    4.09098347242677e-07
    ];


% trun = 28
% total_BER = [
%     0.0880833333333333	0.0327812500000000	0.0161406250000000	0.00847058823529412	0.00431330472103004	0.00205510204081633	0.000854344122657581	0.000386723272867619	0.000158135139392030	2.42494356659142e-05	1.04953820319060e-05;
%     0.0311470588235294	0.00904504504504505	0.00397222222222222	0.00177031802120141	0.000762376237623762	0.000287769784172662	0.000113934146063575	4.66263378315496e-05	2.05697176021821e-05    1.73661360347323e-05    7.5638499897652e-06;
%     0.0205510204081633	0.00611585365853659	0.00242130750605327	0.000957305502846300	0.000337353433835846	8.05519897304236e-05	3.82501145213010e-05    2.41116751269036e-05    8.90587320108907e-06    4.5638499897652e-06 1.69539417914665e-06
% ];




SNR_axis=repmat(2:0.5:7,3,1);
semilogy(2:0.5:7,total_BER,'-o')
axis([2 7 10^(-9) 1])
title('(2,1,4) convolution code with Q =2,4,8 and truncation length=12');
legend('Q=2','Q=4','Q=8');
grid on
xlabel('Eb/No')
ylabel('BER')
set(gcf, 'Position',  [400, 400, 700, 400])
saveas(gcf,'BER(b).jpg')


fileID = fopen('result(b).txt','w');
fprintf(fileID,'(2,1,4) convolution code with Q =2,4,8 and truncation length=12\n');
for i = 1:size(total_BER,2)
    format_2 = ['SNR = %.1f(dB), BER = ' repmat('%0.15f/',1,size(total_BER,1)) '\n'];
    fprintf(fileID,format_2,(i+3)/2,total_BER(:,i));
end

